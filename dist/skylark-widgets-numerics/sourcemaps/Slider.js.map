{"version":3,"sources":["Slider.js"],"names":["define","eventer","Widget","numerics","Slider","inherit","_construct","parent","prototype","call","this","_elm","style","overflow","skin","getSkin","self","text","document","createElement","position","display","justifyContent","alignItems","zIndex","border","borderRadius","color","textColor","backgroundColor","barColor","borderColor","body","appendChild","textValue","createTextNode","onmousemove","event","width","height","left","clientX","top","clientY","onmouseout","track","audioTrack","cursor","progress","pointerEvents","audioProgress","scrubber","audioScrubber","value","onChange","min","max","step","mouseStart","valueStart","on","window","delta","pageX","size","setValue","onmousedown","manager","create","stopPropagation","percentage","layerX","x","setDisabled","setStep","setRange","setOnChange","remainder","stepVal","String","split","length","precision","values","Number","parseFloat","substr","_updateValue","getValue","data","destroy","contains","removeChild"],"mappings":"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","file":"../Slider.js","sourcesContent":["define([\r\n\t\"skylark-domx-eventer\",\r\n\t\"skylark-widgets-base/Widget\",\r\n\t\"./numerics\"\r\n],function(eventer,Widget,numerics){\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n\t * Slider widget is used to select a numeric value using a visual slider bar.\r\n\t * \r\n\t * @class Slider\r\n\t * @extends {Widget}\r\n\t * @param {Widget} parent Parent widget.\r\n\t */\r\n\tvar Slider = Widget.inherit({\r\n\r\n\t\t_construct : function (parent) {\r\n\t\t\tWidget.prototype._construct.call(this, parent, \"div\");\r\n\r\n\t\t\tthis._elm.style.overflow = \"visible\";\r\n\r\n\t\t\tvar skin = this.getSkin();\r\n\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t//Text\r\n\t\t\tthis.text = document.createElement(\"div\");\r\n\t\t\tthis.text.style.position = \"absolute\";\r\n\t\t\tthis.text.style.display = \"none\";\r\n\t\t\tthis.text.style.justifyContent = \"center\";\r\n\t\t\tthis.text.style.alignItems = \"center\";\r\n\t\t\tthis.text.style.zIndex = \"10000\";\r\n\t\t\tthis.text.style.border = \"3px solid\";\r\n\t\t\tthis.text.style.borderRadius = \"5px\";\r\n\r\n\t\t\t//this.text.style.color = Editor.theme.textColor;\r\n\t\t\t//this.text.style.backgroundColor = Editor.theme.barColor;\r\n\t\t\t//this.text.style.borderColor = Editor.theme.barColor;\t\r\n\t\t\tthis.text.style.color = skin.textColor;\r\n\t\t\tthis.text.style.backgroundColor = skin.barColor;\r\n\t\t\tthis.text.style.borderColor = skin.barColor;\t\r\n\r\n\t\t\tdocument.body.appendChild(this.text);\r\n\r\n\t\t\t//Text value\r\n\t\t\tthis.textValue = document.createTextNode(\"\");\r\n\t\t\tthis.text.appendChild(this.textValue);\r\n\r\n\t\t\t//Mouse mouse move event\r\n\t\t\tthis._elm.onmousemove = function(event)\r\n\t\t\t{\r\n\t\t\t\tself.text.style.display = \"flex\";\r\n\t\t\t\tself.text.style.width = \"fit-content\";\r\n\t\t\t\tself.text.style.height = \"fit-content\";\r\n\t\t\t\tself.text.style.left = event.clientX + \"px\";\r\n\t\t\t\tself.text.style.top = (event.clientY - 30) + \"px\";\r\n\t\t\t};\r\n\r\n\t\t\t//Mouse out event\r\n\t\t\tthis._elm.onmouseout = function()\r\n\t\t\t{\r\n\t\t\t\tself.text.style.display = \"none\";\r\n\t\t\t};\r\n\r\n\t\t\t//Track\r\n\t\t\tthis.track = document.createElement(\"div\");\r\n\t\t\tthis.track.style.position = \"absolute\";\r\n\t\t\t//this.track.style.backgroundColor = Editor.theme.audioTrack;\r\n\t\t\tthis.track.style.backgroundColor = skin.audioTrack;\r\n\t\t\tthis.track.style.cursor = \"pointer\";\r\n\t\t\tthis.track.style.left = \"0px\";\r\n\t\t\tthis.track.style.width = \"100%\";\r\n\t\t\tthis.track.style.top = \"25%\";\r\n\t\t\tthis.track.style.height = \"50%\";\r\n\t\t\tthis._elm.appendChild(this.track);\r\n\r\n\t\t\t//Progress\r\n\t\t\tthis.progress = document.createElement(\"div\");\r\n\t\t\tthis.progress.style.pointerEvents = \"none\";\r\n\t\t\tthis.progress.style.position = \"absolute\";\r\n\t\t\t//this.progress.style.backgroundColor = Editor.theme.audioProgress;\r\n\t\t\tthis.progress.style.backgroundColor = skin.audioProgress;\r\n\t\t\tthis.progress.style.height = \"100%\";\r\n\t\t\tthis.track.appendChild(this.progress);\r\n\r\n\t\t\t//Scrubber\r\n\t\t\tthis.scrubber = document.createElement(\"div\");\r\n\t\t\tthis.scrubber.style.position = \"absolute\";\r\n\t\t\t//this.scrubber.style.backgroundColor = Editor.theme.audioScrubber;\r\n\t\t\tthis.scrubber.style.backgroundColor = skin.audioScrubber;\r\n\t\t\tthis.scrubber.style.cursor = \"pointer\";\r\n\t\t\tthis.scrubber.style.height = \"160%\";\r\n\t\t\tthis.scrubber.style.top = \"-25%\";\r\n\t\t\tthis.scrubber.style.width = \"6px\";\r\n\t\t\tthis.track.appendChild(this.scrubber);\r\n\r\n\t\t\t/**\r\n\t\t\t * Value stored in the slider.\r\n\t\t\t *\r\n\t\t\t * @property value\r\n\t\t\t * @type {Number}\r\n\t\t\t */\r\n\t\t\tthis.value = 0.0;\r\n\r\n\t\t\t/**\r\n\t\t\t * On change callback function.\r\n\t\t\t *\r\n\t\t\t * @property onChange\r\n\t\t\t * @type {Function}\r\n\t\t\t */\r\n\t\t\tthis.onChange = null;\r\n\r\n\t\t\t//Range\r\n\t\t\tthis.min = 1.0;\r\n\t\t\tthis.max = 2.0;\r\n\t\t\tthis.step = null;\r\n\r\n\t\t\t//Drag control\r\n\t\t\tthis.mouseStart = 0;\r\n\t\t\tthis.valueStart = 0;\r\n\r\n\t\t\t/**\r\n\t\t\t * Event manager to handle window events.\r\n\t\t\t *\r\n\t\t\t * @property manager\r\n\t\t\t * @type {EventManager}\r\n\t\t\t */\r\n\t\t\t//this.manager = new EventManager();\r\n\t\t\t//this.manager.add(window, \"mousemove\", function(event)\r\n\t\t\teventer.on(window,\"mousemove\", function(event)\r\n\t\t\t{\r\n\t\t\t\tvar delta = (event.pageX - self.mouseStart) / (self.size.x);\r\n\t\t\t\tvar value = self.valueStart + delta * (self.max - self.min);\r\n\t\t\t\tself.setValue(value);\r\n\r\n\t\t\t\tif (self.onChange !== null) {\r\n\t\t\t\t\tself.onChange(self.value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t//this.manager.add(window, \"mouseup\", function(event)\r\n\t\t\teventer.on(window, \"mouseup\", function(event)\r\n\t\t\t{\t\r\n\t\t\t\t//self.manager.destroy();\r\n\t\t\t});\r\n\r\n\t\t\tthis.scrubber.onmousedown = function(event)\r\n\t\t\t{\r\n\t\t\t\tself.mouseStart = event.pageX;\r\n\t\t\t\tself.valueStart = self.value;\r\n\t\t\t\tself.manager.create();\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t};\r\n\r\n\t\t\tthis.track.onmousedown = function(event)\r\n\t\t\t{\r\n\t\t\t\tvar percentage = (event.layerX / self.size.x);\r\n\r\n\t\t\t\tself.setValue(percentage * (self.max - self.min) + self.min);\r\n\t\t\t\tself.progress.style.width = (percentage * 100) + \"%\";\r\n\t\t\t\tself.scrubber.style.left = self.progress.style.width;\r\n\t\t\t\tself.scrubber.onmousedown(event);\r\n\r\n\t\t\t\tif(self.onChange !== null) {\r\n\t\t\t\t\tself.onChange(self.value);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set if widget is disabled.\r\n\t\t *\r\n\t\t * @method setDisabled\r\n\t\t * @param {Boolean} value.\r\n\t\t */\r\n\t\tsetDisabled : function(value) {\r\n\t\t\t//TODO\r\n\t\t},\r\n\r\n\t\t//Set slider min step\r\n\t\tsetStep : function(step) {\r\n\t\t\tthis.step = step;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set value range of the slider.\r\n\t\t *\r\n\t\t * @method setRange.\r\n\t\t * @param {Number} min\r\n\t\t * @param {Number} max\r\n\t\t */\r\n\t\tsetRange : function(min, max) {\r\n\t\t\tthis.min = min;\r\n\t\t\tthis.max = max;\r\n\t\t},\r\n\r\n\t\t/** \r\n\t\t * Set onchange callback.\r\n\t\t *\r\n\t\t * @method setOnChange\r\n\t\t * @param {Function} onChange\r\n\t\t * @param {String} name Graph name.\r\n\t\t */\r\n\t\tsetOnChange : function(onChange) {\r\n\t\t\tthis.onChange = onChange;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set Slider value.\r\n\t\t *\r\n\t\t * @method setValue\r\n\t\t * @param {Number} value\r\n\t\t */\r\n\t\tsetValue : function(value) {\r\n\t\t\tif(value < this.min) {\r\n\t\t\t\tvalue = this.min;\r\n\t\t\t} else if(value > this.max) {\r\n\t\t\t\tvalue = this.max;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.step !== null) {\r\n\t\t\t\tvar remainder = value % this.step;\r\n\r\n\t\t\t\tvalue -= remainder;\r\n\t\t\t\tif(remainder > this.step / 2)\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue += this.step;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Check for precision problems\r\n\t\t\t\tvar stepVal = String(this.step).split(\".\");\r\n\t\t\t\tif(stepVal.length > 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar precision = stepVal[1].length;\r\n\t\t\t\t\tvar values = String(value).split(\".\");\r\n\t\t\t\t\tif(values.length > 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalue = Number.parseFloat(values[0] + \".\" + values[1].substr(0, precision));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.value = value;\r\n\t\t\tthis._updateValue();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get Slider value.\r\n\t\t *\r\n\t\t * @method getValue\r\n\t\t * @return {Number} Value of the slider.\r\n\t\t */\r\n\t\tgetValue : function() {\r\n\t\t\treturn this.value;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Update the DOM elements to represent the value.\r\n\t\t *\r\n\t\t * @method updateValue\r\n\t\t */\r\n\t\t_updateValue : function() {\r\n\t\t\tvar progress = ((this.value - this.min) / (this.max - this.min)) * 100;\r\n\r\n\t\t\tthis.progress.style.width = progress + \"%\";\r\n\t\t\tthis.scrubber.style.left = progress + \"%\";\r\n\t\t\tthis.textValue.data = this.value;\r\n\t\t},\r\n\r\n\t\tdestroy : function() {\r\n\t\t\tWidget.prototype.destroy.call(this);\r\n\t\t\t\r\n\t\t\tif(document.body.contains(this.text))\r\n\t\t\t{\r\n\t\t\t\tdocument.body.removeChild(this.text);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\treturn numerics.Slider = Slider;\r\n});"]}